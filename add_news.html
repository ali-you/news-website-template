<!doctype html>
<html class="no-js" lang="zxx">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Add News</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/new-news-icon.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<header>
    <div class="header-area main-header">
        <div class="header-top">
            <div class=" row col-xl-12 d-flex justify-content-between align-items-center">
                <div class="header-info-left">
                    <div class="header-social d-none d-sm-block" style="margin-left: 50px">
                        <a href="#"><i class="fa fa-facebook-f"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                        <a href="#"><i class="fa fa-linkedin-in"></i></a>
                        <a href="#"><i class="fa fa-tumblr"></i></a>
                    </div>
                </div>
                <div class="header-info-mid">

                    <div class="logo">
                        <a href="index.html"><img src="assets/img/new-news-logo2.png" width='400' height="auto"></a>
                    </div>
                </div>
                <div class="header-info-right d-flex align-items-center">
                    <ul id="login_state">
                        <li>
                            <form class="search-form" action="search_screen.html">
                                <i class="fa fa-search"></i>
                                <input type="search" class="form-control" placeholder="Search Here"
                                       title="Search here" name="search">
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="header-bottom  header-sticky">
            <div class="row align-items-center">
                <div class="col-xl-12">
                    <div class="logo2">
                        <a><img src="assets/img/new-news-logo2.png" width='350' height="auto"></a>
                    </div>
                    <div class="logo3 d-block d-sm-none">
                        <a><img src="assets/img/new-news-logo2.png" width='300' height="auto"></a>
                    </div>

                    <div class="main-menu text-center d-none d-lg-block">
                        <nav>
                            <ul id="navigation">
                                <li><a href="index.html">Home</a></li>
                                <li><a href="category.html?category=Politics">Politics</a></li>
                                <li><a href="category.html?category=Health">Health</a></li>
                                <li><a href="category.html?category=Economics">Economics</a></li>
                                <li><a href="category.html?category=Sport">Sport</a></li>
                                <li><a href="category.html?category=Technology">Technology</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <div class="col-xl-12">
                    <div class="mobile_menu d-block d-lg-none"></div>
                </div>
            </div>
        </div>
    </div>
</header>
<main>
    <div class="register-form-area" style="margin-top: 70px">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-6 col-lg-7 col-md-10">
                    <div class="register-form text-center">

                        <div class="register-heading">
                            <span>Add News</span>
                        </div>

                        <div class="input-box">
                            <div class="single-input-fields">
                                <label>Title *</label>
                                <input type="text" placeholder="Enter news title" id="addNewsTitle" style="margin: 0">
                                <p class="text-left" style="color: red" id="addNewsTitle_err"></p>

                            </div>
                            <div class="single-input-fields">
                                <label>Body *</label>
                                <input type="text" placeholder="Enter news body" id="addNewsBody" style="margin: 0">
                                <p class="text-left" style="color: red" id="addNewsBody_err"></p>
                            </div>

                            <div class="single-input-fields">
                                <label>Image URL</label>
                                <input type="url" placeholder="Enter news image url" id="addNewsImage">
                            </div>

                            <div class="single-input-fields">
                                <label>View</label>
                                <input type="number" placeholder="Enter initial view" id="addNewsView">
                            </div>

                            <div class="single-element-widget mt-30 single-input-fields">
                                <label class="mb-30">Category</label>
                                <div class="default-select">
                                    <select id="addNewsClass">
                                        <option value="Politics">Politics</option>
                                        <option value="Health">Health</option>
                                        <option value="Economics">Economics</option>
                                        <option value="Sport">Sport</option>
                                        <option value="Technology">Technology</option>
                                    </select>
                                </div>
                            </div>

                        </div>

                        <div class="register-footer">
                            <button class="btn" onclick="addNews()" id="btn">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</main>
<footer>
    <div class="footer-area footer-padding">
        <div class="container">
            <div class="row d-flex justify-content-between">
                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="single-footer-caption mb-30">

                            <div class="footer-logo mb-25">
                                <a href="index.html"><img src="assets/img/new-news-logo2.png" width="300" height="auto"></a>
                            </div>
                            <div class="footer-tittle">
                                <div class="footer-pera">
                                    <p>Science is a beautiful gift to humanity We should not distort it</p>
                                </div>
                            </div>
                            <div class="footer-social">
                                <a href="#"><i class="fa fa-facebook-f"></i></a>
                                <a href="#"><i class="fa fa-instagram"></i></a>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                                <a href="#"><i class="fa fa-linkedin-in"></i></a>
                                <a href="#"><i class="fa fa-tumblr"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-2 col-lg-2 col-md-4 col-sm-5">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle">
                            <h4>Useful links</h4>
                            <ul>
                                <li><a href="#">About Me</a></li>
                                <li><a href="#">Become an Writer</a></li>
                                <li><a href="#">Privacy & Policy</a></li>
                                <li><a href="#">Terms</a></li>
                                <li><a href="#">Contact Us</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle">
                            <h4>Top Categories</h4>
                            <ul>
                                <li><a href="category.html?category=Politics">Politics</a></li>
                                <li><a href="category.html?category=Health"> Health</a></li>
                                <li><a href="category.html?category=Economics">Economics</a></li>
                                <li><a href="category.html?category=Sport">Sport</a></li>
                                <li><a href="category.html?category=Technology">Technology</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle mb-50">
                            <h4>Subscribe Newsletter</h4>
                            <p>Subscribe our newsletter to get update news & updates.</p>
                        </div>

                        <div class="footer-form">
                            <div id="mc_embed_signup">
                                <form target="_blank"
                                      class="subscribe_form relative mail_part" novalidate>
                                    <input type="email" name="EMAIL" id="newsletter-form-email"
                                           placeholder="  Enter your email">
                                    <div class="form-icon">
                                        <button type="submit" name="submit" id="newsletter-submit"
                                                class="email_icon newsletter-submit button-contactForm">
                                            Subscribe
                                        </button>
                                    </div>
                                    <div class="mt-10 info"></div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer-bottom-area">
        <div class="container">
            <div class="row d-flex align-items-center footer-border">
                <div class="col-xl-12 footer-copy-right text-center">
                    <p>Copyright &copy;<script>document.write(new Date().getFullYear());</script>
                        All rights reserved | Made with <i class="fa fa-heart color-danger"
                                                           aria-hidden="true"></i> by <a
                                rel="nofollow noopener">Ali Yousefi</a>
                    </p>

                </div>
            </div>
        </div>
    </div>
</footer>

<div id="back-top">
    <a title="Go to Top"> <i class="fa fa-arrow-up" style="color: white"></i></a>
</div>

<script src="js/vendor/modernizr-3.5.0.min.js"></script>
<script src="js/vendor/jquery-1.12.4.min.js"></script>
<script src="js/popper.min.js+bootstrap.min.js.pagespeed.jc.-Z5m6ljAND.js"></script>
<script type="text/javascript" src="js/api.js"></script>
<script type="text/javascript" src="js/customAlert.js"></script>
<script>
    if (localStorage.getItem('token') === null)
        localStorage.setItem('token', '');
    if (localStorage.getItem('token') === '')
        localStorage.setItem('token', guestToken);

    if (isLogin()) {
        document.getElementById('login_state').innerHTML += `<li><a class="header-btn">${getCookie('username')}</a>
                                            <ul class="multipage">
                                                <li><a href="about.html"><i class="fa fa-user" style="padding-right: 10px"></i>Profile</a></li>
                                                <li><a href="blog.html"><i class="fa fa-plus-square" style="padding-right: 10px"></i>Add news</a></li>
                                                <li><a href="blog.html"><i class="fa fa-cog" style="padding-right: 10px"></i>Setting</a></li>
                                                <li><a href="#" onclick="logout('index.html');"><i class="fa fa-sign-out" style="padding-right: 10px"></i>Logout</a></li>
                                            </ul>
                                        </li>`
    } else document.getElementById('login_state').innerHTML += `<li><a href="login.html" class="header-btn" id="login_button">Sign in</a></li>`

</script>
<script>
    async function addNews() {
        document.getElementById('addNewsTitle_err').innerHTML = '';
        document.getElementById('addNewsBody_err').innerHTML = '';

        const newsTitle = document.getElementById('addNewsTitle').value;
        const newsBody = document.getElementById('addNewsBody').value;
        const newsImage = document.getElementById('addNewsImage').value;
        var viewCounter = document.getElementById('addNewsView').value;
        const newsClass = document.getElementById('addNewsClass').value;

        if (newsTitle === '')
            document.getElementById('addNewsTitle_err').innerHTML = 'This field can\'t be empty';
        if (newsBody === '')
            document.getElementById('addNewsBody_err').innerHTML = 'This field can\'t be empty';
        if (viewCounter === '' || viewCounter < 0)
            viewCounter = 0;
        if (newsTitle !== '' && newsBody !== '') {
            let myBody = newsImage !== '' ?
                {
                    "newsTitle": newsTitle,
                    "newsBody": newsBody,
                    "imageUrl": newsImage,
                    "viewCounter": viewCounter,
                    "newsClass": newsClass,
                    "userID": getCookie('uid')
                } :
                {
                    "newsTitle": newsTitle,
                    "newsBody": newsBody,
                    "viewCounter": viewCounter,
                    "newsClass": newsClass,
                    "userID": getCookie('uid')
                };

            let
                statusCode;
            const response = await fetch(/*'https://news-websitex.herokuapp.com/api/user'*/'http://127.0.0.1:8000/api/addnews', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Token ' + localStorage.getItem('token')
                },
                body: JSON.stringify(myBody),
            })
                .then(function (res) {
                        statusCode = res.status;
                        return res.json();
                    }
                )
                .then(data => {
                    console.log('success: ', data);
                    console.log(statusCode.toString());
                    // if (statusCode === 400)
                    //     document.getElementById('addNewsTitle_err').innerHTML = data['newsTitle'];
                    //     document.getElementById('addNewsBody_err').innerHTML = data['newsBody'];
                    if (statusCode === 201) {

                        document.getElementById('addNewsTitle').value = '';
                        document.getElementById('addNewsBody').value = '';
                        document.getElementById('addNewsImage').value = '';
                        document.getElementById('addNewsView').value = '';
                        customAlertObj(
                            "Success", //message
                            "success", //type:info/warning/success/error
                            "News Created successfully", //details
                            5000 //duration
                        );
                    }

                    // window.location.replace("login.html");
                });
        }
        // const myJson = await response.json();
        // console.log(myJson)
    }

    // document.getElementById("btn").addEventListener("click", function () {
    //     customAlertObj(
    //         "I am a success message", //message
    //         "success", //type:info/warning/success/error
    //         "After 5 seconds it will be gone", //details
    //         5000 //duration
    //     );
    // });
</script>
<script>eval(mod_pagespeed_aaYokwErtx);</script>
<script>eval(mod_pagespeed_gMJAcNlmbI);</script>

<script src="js/owl.carousel.min.js+slick.min.js.pagespeed.jc.F6wXCct6U2.js"></script>
<script>eval(mod_pagespeed_KlLvOZN8Fy);</script>
<script>eval(mod_pagespeed_$TEYNsEnUF);</script>
<script src="js/lightslider.min.js+jquery.slicknav.min.js+wow.min.js+jquery.js"></script>
<script>eval(mod_pagespeed_SsjX9wl8YK);</script>
<script>eval(mod_pagespeed_FsFY_1b99X);</script>

<script>eval(mod_pagespeed_yCBvmSHiqi);</script>
<script>eval(mod_pagespeed_6wgZmOj4mJ);</script>
<script>eval(mod_pagespeed_ACR6aNIQJ0);</script>

<script>eval(mod_pagespeed_l3DmqqKHpk);</script>
<script src="js/jquery.form.js+jquery.validate.min.js+mail-script.js+jquery.js"></script>
<script>eval(mod_pagespeed_Tz7N8H_GxJ);</script>
<script>eval(mod_pagespeed_eCe2npfiIC);</script>
<script>eval(mod_pagespeed_IEpshS3M$A);</script>
<script>eval(mod_pagespeed_no8v3TXY1I);</script>

<script>eval(mod_pagespeed_Xuk2NU2Nkf);</script>
<script>eval(mod_pagespeed_$TGHfHB1G2);</script>

</body>
</html>