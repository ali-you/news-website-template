<!doctype html>
<html class="no-js" lang="zxx">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Setting</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/new-news-icon.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<header>
    <div class="header-area main-header">
        <div class="header-top">
            <div class=" row col-xl-12 d-flex justify-content-between align-items-center">
                <div class="header-info-left">
                    <div class="header-social d-none d-sm-block" style="margin-left: 50px">
                        <a href="#"><i class="fa fa-facebook-f"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                        <a href="#"><i class="fa fa-linkedin-in"></i></a>
                        <a href="#"><i class="fa fa-tumblr"></i></a>
                    </div>
                </div>
                <div class="header-info-mid">

                    <div class="logo">
                        <a href="index.html"><img src="assets/img/new-news-logo2.png" width='400' height="auto"></a>
                    </div>
                </div>
                <div class="header-info-right d-flex align-items-center">
                    <ul id="login_state">
                        <li>
                            <form class="search-form" action="search_screen.html">
                                <i class="fa fa-search"></i>
                                <input type="search" class="form-control" placeholder="Search Here"
                                       title="Search here" name="search">
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="header-bottom  header-sticky">
            <div class="row align-items-center">
                <div class="col-xl-12">
                    <div class="logo2">
                        <a><img src="assets/img/new-news-logo2.png" width='350' height="auto"></a>
                    </div>
                    <div class="logo3 d-block d-sm-none">
                        <a><img src="assets/img/new-news-logo2.png" width='300' height="auto"></a>
                    </div>

                    <div class="main-menu text-center d-none d-lg-block">
                        <nav>
                            <ul id="navigation">
                                <li><a href="index.html">Home</a></li>
                                <li><a href="category.html?category=Politics">Politics</a></li>
                                <li><a href="category.html?category=Health">Health</a></li>
                                <li><a href="category.html?category=Economics">Economics</a></li>
                                <li><a href="category.html?category=Sport">Sport</a></li>
                                <li><a href="category.html?category=Technology">Technology</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <div class="col-xl-12">
                    <div class="mobile_menu d-block d-lg-none"></div>
                </div>
            </div>
        </div>
    </div>
</header>
<main>

    <section class="whats-news-area pt-50 pb-20">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 whats-news-wrapper">

                    <div class="row justify-content-between align-items-end mb-15">
                        <div class="col-xl-12">
                            <div class="section-tittle section-tittle2 mb-30 d-flex align-items-center justify-content-between flex-wrap properties__button">
                                <nav>
                                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                        <a class="nav-item nav-link active" id="nav-profile-tab" data-toggle="tab"
                                           href="#nav-Profile" role="tab" aria-controls="nav-home"
                                           aria-selected="true">Profile</a>
                                        <a class="nav-item nav-link" id="nav-appearance-tab" data-toggle="tab"
                                           href="#nav-Appearance" role="tab" aria-controls="nav-contact"
                                           aria-selected="false">Appearance</a>
                                    </div>
                                </nav>

                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">

                            <div class="tab-content" id="nav-tabContent">

                                <div class="tab-pane fade show active" id="nav-Profile" role="tabpanel"
                                     aria-labelledby="nav-profile-tab">

                                    <div class="col-xl-12 col-lg-12 justify-content-center align-items-center">
                                        <div class="register-form-area">
                                            <div class="container">
                                                <div class="row justify-content-center">
                                                    <div class="col-xl-6 col-lg-7 col-md-10">
                                                        <div class="register-form text-center">


                                                            <div class="input-box">


                                                                <div class="single-input-fields">
                                                                    <label>Image URL</label>
                                                                    <input type="url" placeholder="Enter news image url"
                                                                           id="setting-image">
                                                                </div>

                                                                <div class="single-input-fields">
                                                                    <label>Bio</label>
                                                                    <input type="text" placeholder="Enter your bio"
                                                                           id="setting-bio">
                                                                </div>


                                                                <div class="single-element-widget mt-30 single-input-fields">
                                                                    <label class="mb-30">Favorite Category</label>
                                                                    <div class="single-input-fields login-check">
                                                                        <input type="checkbox" id="cat1" name="cat1"
                                                                               value="Politics">
                                                                        <label for="cat1">Politics</label>
                                                                        <input type="checkbox" id="cat2" name="cat2"
                                                                               value="Health">
                                                                        <label for="cat2">Health</label>
                                                                        <input type="checkbox" id="cat3" name="cat3"
                                                                               value="Economics">
                                                                        <label for="cat3">Economics</label>
                                                                        <input type="checkbox" id="cat4" name="cat4"
                                                                               value="Sport">
                                                                        <label for="cat4">Sport</label>
                                                                        <input type="checkbox" id="cat5" name="cat5"
                                                                               value="Technology">
                                                                        <label for="cat5">Technology</label>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="register-footer">
                                                                <button class="btn" onclick="editProfile()">Save
                                                                    changes
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>


                                <div class="tab-pane fade" id="nav-Appearance" role="tabpanel"
                                     aria-labelledby="nav-appearance-tab">

                                    <div class="col-xl-12 col-lg-12 justify-content-center align-items-center">
                                        <div class="register-form-area">
                                            <div class="container">
                                                <div class="row justify-content-center">
                                                    <div class="col-xl-6 col-lg-7 col-md-10">
                                                        <div class="register-form text-center">


                                                            <div class="input-box">


                                                                <div class="single-input-fields">
                                                                    <label>Bio</label>


                                                                    <div class="position-relative mb-3 flex-shrink-0 col-6 col-md-4">
                                                                        <input
                                                                                class="position-absolute"
                                                                                id="option-light"
                                                                                type="radio"
                                                                                name="user_theme"
                                                                                data-type="light"
                                                                                data-mode="light"
                                                                                value="light"

                                                                                style="position:absolute;z-index:5;bottom:12px;left:19px;"
                                                                                data-action="click:appearance-form#themeClicked"
                                                                                data-throttled-autosubmit
                                                                        >
                                                                        <label
                                                                                class="radio-label pl-0 pr-0 pt-0 pb-2 overflow-hidden hx_theme-toggle width-full"
                                                                                for="option-light"
                                                                        >
                                                                            <img alt=""
                                                                                 class="d-block border-bottom mb-2 width-full"
                                                                                 src="https://github.githubassets.com/images/modules/settings/color_modes/light_preview.svg"/>
                                                                            <span class="ml-5">Light default</span>
                                                                        </label>
                                                                    </div>
                                                                    <div class="position-relative mb-3 flex-shrink-0 col-6 col-md-4">
                                                                        <input
                                                                                class="position-absolute"
                                                                                id="option-light_high_contrast"
                                                                                type="radio"
                                                                                name="user_theme"
                                                                                data-type="light"
                                                                                data-mode="light"
                                                                                value="light_high_contrast"

                                                                                style="position:absolute;z-index:5;bottom:12px;left:19px;"
                                                                                data-action="click:appearance-form#themeClicked"
                                                                                data-throttled-autosubmit
                                                                        >
                                                                        <label
                                                                                class="radio-label pl-0 pr-0 pt-0 pb-2 overflow-hidden hx_theme-toggle width-full"
                                                                                for="option-light_high_contrast"
                                                                        >
                                                                            <img alt=""
                                                                                 class="d-block border-bottom mb-2 width-full"
                                                                                 src="https://github.githubassets.com/images/modules/settings/color_modes/light_high_contrast_preview.svg"/>
                                                                            <span class="ml-5">Light high contrast</span>
                                                                        </label>
                                                                    </div>
                                                                    <div class="position-relative mb-3 flex-shrink-0 col-6 col-md-4">
                                                                        <input
                                                                                class="position-absolute"
                                                                                id="option-dark"
                                                                                type="radio"
                                                                                name="user_theme"
                                                                                data-type="dark"
                                                                                data-mode="dark"
                                                                                value="dark"
                                                                                checked
                                                                                style="position:absolute;z-index:5;bottom:12px;left:19px;"
                                                                                data-action="click:appearance-form#themeClicked"
                                                                                data-throttled-autosubmit
                                                                        >
                                                                        <label
                                                                                class="radio-label pl-0 pr-0 pt-0 pb-2 overflow-hidden hx_theme-toggle width-full"
                                                                                for="option-dark"
                                                                        >
                                                                            <img alt=""
                                                                                 class="d-block border-bottom mb-2 width-full"
                                                                                 src="https://github.githubassets.com/images/modules/settings/color_modes/dark_preview.svg"/>
                                                                            <span class="ml-5">Dark default</span>
                                                                        </label>
                                                                    </div>
                                                                    <div class="position-relative mb-3 flex-shrink-0 col-6 col-md-4">
                                                                        <input
                                                                                class="position-absolute"
                                                                                id="option-dark_high_contrast"
                                                                                type="radio"
                                                                                name="user_theme"
                                                                                data-type="dark"
                                                                                data-mode="dark"
                                                                                value="dark_high_contrast"

                                                                                style="position:absolute;z-index:5;bottom:12px;left:19px;"
                                                                                data-action="click:appearance-form#themeClicked"
                                                                                data-throttled-autosubmit
                                                                        >
                                                                        <label
                                                                                class="radio-label pl-0 pr-0 pt-0 pb-2 overflow-hidden hx_theme-toggle width-full"
                                                                                for="option-dark_high_contrast"
                                                                        >
                                                                            <img alt=""
                                                                                 class="d-block border-bottom mb-2 width-full"
                                                                                 src="https://github.githubassets.com/images/modules/settings/color_modes/dark_high_contrast_preview.svg"/>
                                                                            <span class="ml-5">Dark high contrast</span>
                                                                        </label>
                                                                    </div>
                                                                    <div class="position-relative mb-3 flex-shrink-0 col-6 col-md-4">
                                                                        <input
                                                                                class="position-absolute"
                                                                                id="option-dark_dimmed"
                                                                                type="radio"
                                                                                name="user_theme"
                                                                                data-type="dark"
                                                                                data-mode="dark"
                                                                                value="dark_dimmed"

                                                                                style="position:absolute;z-index:5;bottom:12px;left:19px;"
                                                                                data-action="click:appearance-form#themeClicked"
                                                                                data-throttled-autosubmit
                                                                        >
                                                                        <label
                                                                                class="radio-label pl-0 pr-0 pt-0 pb-2 overflow-hidden hx_theme-toggle width-full"
                                                                                for="option-dark_dimmed"
                                                                        >
                                                                            <img alt=""
                                                                                 class="d-block border-bottom mb-2 width-full"
                                                                                 src="https://github.githubassets.com/images/modules/settings/color_modes/dark_dimmed_preview.svg"/>
                                                                            <span class="ml-5">Dark dimmed</span>
                                                                        </label>
                                                                    </div>
                                                                </div>


                                                            </div>

                                                        </div>


                                                        <div class="register-footer">
                                                            <button class="btn" onclick="registerAPI()">Save
                                                                changes
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>


                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>


</main>
<footer>
    <div class="footer-area footer-padding">
        <div class="container">
            <div class="row d-flex justify-content-between">
                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="single-footer-caption mb-30">

                            <div class="footer-logo mb-25">
                                <a href="index.html"><img src="assets/img/new-news-logo2.png" width="300" height="auto"></a>
                            </div>
                            <div class="footer-tittle">
                                <div class="footer-pera">
                                    <p>Science is a beautiful gift to humanity We should not distort it</p>
                                </div>
                            </div>
                            <div class="footer-social">
                                <a href="#"><i class="fa fa-facebook-f"></i></a>
                                <a href="#"><i class="fa fa-instagram"></i></a>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                                <a href="#"><i class="fa fa-linkedin-in"></i></a>
                                <a href="#"><i class="fa fa-tumblr"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-2 col-lg-2 col-md-4 col-sm-5">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle">
                            <h4>Useful links</h4>
                            <ul>
                                <li><a href="#">About Me</a></li>
                                <li><a href="#">Become an Writer</a></li>
                                <li><a href="#">Privacy & Policy</a></li>
                                <li><a href="#">Terms</a></li>
                                <li><a href="#">Contact Us</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle">
                            <h4>Top Categories</h4>
                            <ul>
                                <li><a href="category.html?category=Politics">Politics</a></li>
                                <li><a href="category.html?category=Health"> Health</a></li>
                                <li><a href="category.html?category=Economics">Economics</a></li>
                                <li><a href="category.html?category=Sport">Sport</a></li>
                                <li><a href="category.html?category=Technology">Technology</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6">
                    <div class="single-footer-caption mb-50">
                        <div class="footer-tittle mb-50">
                            <h4>Subscribe Newsletter</h4>
                            <p>Subscribe our newsletter to get update news & updates.</p>
                        </div>

                        <div class="footer-form">
                            <div id="mc_embed_signup">
                                <form target="_blank"
                                      class="subscribe_form relative mail_part" novalidate>
                                    <input type="email" name="EMAIL" id="newsletter-form-email"
                                           placeholder="  Enter your email">
                                    <div class="form-icon">
                                        <button type="submit" name="submit" id="newsletter-submit"
                                                class="email_icon newsletter-submit button-contactForm">
                                            Subscribe
                                        </button>
                                    </div>
                                    <div class="mt-10 info"></div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer-bottom-area">
        <div class="container">
            <div class="row d-flex align-items-center footer-border">
                <div class="col-xl-12 footer-copy-right text-center">
                    <p>Copyright &copy;<script>document.write(new Date().getFullYear());</script>
                        All rights reserved | Made with <i class="fa fa-heart color-danger"
                                                           aria-hidden="true"></i> by <a
                                rel="nofollow noopener">Ali Yousefi</a>
                    </p>

                </div>
            </div>
        </div>
    </div>
</footer>

<div id="back-top">
    <a title="Go to Top"> <i class="fa fa-arrow-up" style="color: white"></i></a>
</div>


<script src="js/vendor/modernizr-3.5.0.min.js"></script>
<script src="js/vendor/jquery-1.12.4.min.js"></script>
<script src="js/popper.min.js+bootstrap.min.js.pagespeed.jc.-Z5m6ljAND.js"></script>
<script type="text/javascript" src="js/api.js"></script>
<script type="text/javascript" src="js/customAlert.js"></script>
<script>
    if (localStorage.getItem('token') === null)
        localStorage.setItem('token', '');
    if (localStorage.getItem('token') === '')
        localStorage.setItem('token', guestToken);

    if (isLogin()) {
        document.getElementById('login_state').innerHTML += `<li><a class="header-btn">${getCookie('username')}</a>
                                            <ul class="multipage">
                                                <li><a href="about.html"><i class="fa fa-user" style="padding-right: 10px"></i>Profile</a></li>
                                                <li><a href="blog.html"><i class="fa fa-plus-square" style="padding-right: 10px"></i>Add news</a></li>
                                                <li><a href="blog.html"><i class="fa fa-cog" style="padding-right: 10px"></i>Setting</a></li>
                                                <li><a href="#" onclick="logout('index.html');"><i class="fa fa-sign-out" style="padding-right: 10px"></i>Logout</a></li>
                                            </ul>
                                        </li>`
    } else document.getElementById('login_state').innerHTML += `<li><a href="login.html" class="header-btn" id="login_button">Sign in</a></li>`

</script>
<script>
    let getProfile = () => {
        // fetch('https://news-websitex.herokuapp.com/api/news')
        fetch('http://127.0.0.1:8000/api/getprofilebyusername/' + getCookie('username'), {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Token ' + localStorage.getItem('token')
            },
        })
            .then(res => res.json())
            .then(response => {
                console.log('success: ', response);
                buildProfile(response);
            });
    };
    getProfile();
    let buildProfile = (news) => {
        document.getElementById('setting-bio').value = news.bio;
        document.getElementById('setting-image').value = news.imageUrl;
        var cat1 = document.getElementById('cat1');
        var cat2 = document.getElementById('cat2');
        var cat3 = document.getElementById('cat3');
        var cat4 = document.getElementById('cat4');
        var cat5 = document.getElementById('cat5');
        var category = news.userCategory.split(',');

        category.forEach(function (value) {
            if (value === cat1.value)
                cat1.checked = true;
            if (value === cat2.value)
                cat2.checked = true;
            if (value === cat3.value)
                cat3.checked = true;
            if (value === cat4.value)
                cat4.checked = true;
            if (value === cat5.value)
                cat5.checked = true;
        });

        document.getElementById('setting-bio').value = news.bio;

    };
</script>
<script>
    async function editProfile() {

        const imageUrl = document.getElementById('setting-image').value === '' ?
            'https://www.gravatar.com/avatar/1abe5daca3f11ecbdae87e302f5cf00f?s=256&d=identicon&r=PG&f=1'
            : document.getElementById('setting-image').value;
        const bio = document.getElementById('setting-bio').value;
        var category = [];
        var cat1 = document.getElementById('cat1');
        var cat2 = document.getElementById('cat2');
        var cat3 = document.getElementById('cat3');
        var cat4 = document.getElementById('cat4');
        var cat5 = document.getElementById('cat5');
        if (cat1.checked === true)
            category.push(cat1.value);
        if (cat2.checked === true)
            category.push(cat2.value);
        if (cat3.checked === true)
            category.push(cat3.value);
        if (cat4.checked === true)
            category.push(cat4.value);
        if (cat5.checked === true)
            category.push(cat5.value);
        let myBody =
            {
                "userCategory": category.toString(),
                "imageUrl": imageUrl,
                "bio": bio,
            };
        let
            statusCode;
        const response = await fetch(/*'https://news-websitex.herokuapp.com/api/user'*/'http://127.0.0.1:8000/api/profile/' + getCookie('uid'), {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Token ' + localStorage.getItem('token')
            },
            body: JSON.stringify(myBody),
        })
            .then(function (res) {
                    statusCode = res.status;
                    return res.json();
                }
            )
            .then(data => {
                console.log('success: ', data);
                console.log(statusCode.toString());
                // if (statusCode === 400)
                //     document.getElementById('addNewsTitle_err').innerHTML = data['newsTitle'];
                //     document.getElementById('addNewsBody_err').innerHTML = data['newsBody'];
                if (statusCode === 200) {
                    document.cookie = "category=" + data['userCategory'];
                    customAlertObj(
                        "Success", //message
                        "success", //type:info/warning/success/error
                        "Profile edited successfully", //details
                        5000 //duration
                    );
                }

                // window.location.replace("login.html");
            });
    }

    // const myJson = await response.json();
    // console.log(myJson)

</script>
<script>eval(mod_pagespeed_aaYokwErtx);</script>
<script>eval(mod_pagespeed_gMJAcNlmbI);</script>

<script src="js/owl.carousel.min.js+slick.min.js.pagespeed.jc.F6wXCct6U2.js"></script>
<script>eval(mod_pagespeed_KlLvOZN8Fy);</script>
<script>eval(mod_pagespeed_$TEYNsEnUF);</script>
<script src="js/lightslider.min.js+jquery.slicknav.min.js+wow.min.js+jquery.js"></script>
<script>eval(mod_pagespeed_SsjX9wl8YK);</script>
<script>eval(mod_pagespeed_FsFY_1b99X);</script>

<script>eval(mod_pagespeed_yCBvmSHiqi);</script>
<script>eval(mod_pagespeed_6wgZmOj4mJ);</script>
<script>eval(mod_pagespeed_ACR6aNIQJ0);</script>

<script>eval(mod_pagespeed_l3DmqqKHpk);</script>
<script src="js/jquery.form.js+jquery.validate.min.js+mail-script.js+jquery.js"></script>
<script>eval(mod_pagespeed_Tz7N8H_GxJ);</script>
<script>eval(mod_pagespeed_eCe2npfiIC);</script>
<script>eval(mod_pagespeed_IEpshS3M$A);</script>
<script>eval(mod_pagespeed_no8v3TXY1I);</script>

<script>eval(mod_pagespeed_Xuk2NU2Nkf);</script>
<script>eval(mod_pagespeed_$TGHfHB1G2);</script>

</body>
</html>